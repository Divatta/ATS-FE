{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport React, { useCallback, useState, useEffect } from \"react\";\nfunction AuthApi(token) {\n  _s();\n  // login status\n  const [isLogged, setIsLogged] = useState(false);\n\n  // roles\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [isUser, setIsUser] = useState(false);\n\n  // user\n  const [user, setUser] = useState(false);\n  const initData = useCallback(() => {\n    const getUser = async () => {\n      const token = localStorage.getItem(\"accessToken\") || false;\n      console.log(\"token =\", token);\n      if (token) {\n        const res = await axios.get(`/api/v1/auth/currentUser`, {\n          headers: {\n            Authorization: token\n          }\n        });\n        console.log(\"current user =\", res.data);\n        setUser(res.data.user);\n        setIsLogged(true);\n        if (res.data.user.role === \"superadmin\") {\n          setIsAdmin(true);\n        } else if (res.data.user.role === \"user\") {\n          // setIsUser(true);\n          setIsAdmin(true);\n        }\n      }\n    };\n    getUser();\n  }, [isAdmin, isLogged, isUser, user]);\n  useEffect(() => {\n    initData();\n  }, []);\n  return {\n    isLogged: [isLogged, setIsLogged],\n    isAdmin: [isAdmin, setIsAdmin],\n    isUser: [isUser, setIsUser],\n    user: [user, setUser] // shows the new user details in component context.provider\n  };\n}\n_s(AuthApi, \"XarPWrHFl2exVBZWr0RqbJqlsPY=\");\n_c = AuthApi;\nexport default AuthApi;\nvar _c;\n$RefreshReg$(_c, \"AuthApi\");","map":{"version":3,"names":["axios","React","useCallback","useState","useEffect","AuthApi","token","_s","isLogged","setIsLogged","isAdmin","setIsAdmin","isUser","setIsUser","user","setUser","initData","getUser","localStorage","getItem","console","log","res","get","headers","Authorization","data","role","_c","$RefreshReg$"],"sources":["/Users/meriness/Desktop/Full stack developer/ATS/frontend/src/Component/API/AuthApi.js"],"sourcesContent":["import axios from \"axios\";\r\nimport React, { useCallback, useState, useEffect } from \"react\";\r\n\r\nfunction AuthApi(token) {\r\n  // login status\r\n  const [isLogged, setIsLogged] = useState(false);\r\n\r\n  // roles\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const [isUser, setIsUser] = useState(false);\r\n\r\n  // user\r\n  const [user, setUser] = useState(false);\r\n\r\n  const initData = useCallback(() => {\r\n    const getUser = async () => {\r\n      const token = localStorage.getItem(\"accessToken\") || false;\r\n      console.log(\"token =\", token);\r\n      if (token) {\r\n        const res = await axios.get(`/api/v1/auth/currentUser`, {\r\n          headers: {\r\n            Authorization: token,\r\n          },\r\n        });\r\n        console.log(\"current user =\", res.data);\r\n        setUser(res.data.user);\r\n        setIsLogged(true);\r\n        if (res.data.user.role === \"superadmin\") {\r\n          setIsAdmin(true);\r\n        } else if (res.data.user.role === \"user\") {\r\n          // setIsUser(true);\r\n          setIsAdmin(true);\r\n        }\r\n      }\r\n    };\r\n\r\n    getUser();\r\n  }, [isAdmin, isLogged, isUser, user]);\r\n\r\n  useEffect(() => {\r\n    initData();\r\n  }, []);\r\n\r\n  return {\r\n    isLogged: [isLogged, setIsLogged],\r\n    isAdmin: [isAdmin, setIsAdmin],\r\n    isUser: [isUser, setIsUser],\r\n\r\n    user: [user, setUser] // shows the new user details in component context.provider\r\n  };\r\n}\r\n\r\nexport default AuthApi;\r\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,IAAIC,WAAW,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAE/D,SAASC,OAAOA,CAACC,KAAK,EAAE;EAAAC,EAAA;EACtB;EACA,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGN,QAAQ,CAAC,KAAK,CAAC;;EAE/C;EACA,MAAM,CAACO,OAAO,EAAEC,UAAU,CAAC,GAAGR,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACS,MAAM,EAAEC,SAAS,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;;EAE3C;EACA,MAAM,CAACW,IAAI,EAAEC,OAAO,CAAC,GAAGZ,QAAQ,CAAC,KAAK,CAAC;EAEvC,MAAMa,QAAQ,GAAGd,WAAW,CAAC,MAAM;IACjC,MAAMe,OAAO,GAAG,MAAAA,CAAA,KAAY;MAC1B,MAAMX,KAAK,GAAGY,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC,IAAI,KAAK;MAC1DC,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEf,KAAK,CAAC;MAC7B,IAAIA,KAAK,EAAE;QACT,MAAMgB,GAAG,GAAG,MAAMtB,KAAK,CAACuB,GAAG,CAAE,0BAAyB,EAAE;UACtDC,OAAO,EAAE;YACPC,aAAa,EAAEnB;UACjB;QACF,CAAC,CAAC;QACFc,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAEC,GAAG,CAACI,IAAI,CAAC;QACvCX,OAAO,CAACO,GAAG,CAACI,IAAI,CAACZ,IAAI,CAAC;QACtBL,WAAW,CAAC,IAAI,CAAC;QACjB,IAAIa,GAAG,CAACI,IAAI,CAACZ,IAAI,CAACa,IAAI,KAAK,YAAY,EAAE;UACvChB,UAAU,CAAC,IAAI,CAAC;QAClB,CAAC,MAAM,IAAIW,GAAG,CAACI,IAAI,CAACZ,IAAI,CAACa,IAAI,KAAK,MAAM,EAAE;UACxC;UACAhB,UAAU,CAAC,IAAI,CAAC;QAClB;MACF;IACF,CAAC;IAEDM,OAAO,EAAE;EACX,CAAC,EAAE,CAACP,OAAO,EAAEF,QAAQ,EAAEI,MAAM,EAAEE,IAAI,CAAC,CAAC;EAErCV,SAAS,CAAC,MAAM;IACdY,QAAQ,EAAE;EACZ,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IACLR,QAAQ,EAAE,CAACA,QAAQ,EAAEC,WAAW,CAAC;IACjCC,OAAO,EAAE,CAACA,OAAO,EAAEC,UAAU,CAAC;IAC9BC,MAAM,EAAE,CAACA,MAAM,EAAEC,SAAS,CAAC;IAE3BC,IAAI,EAAE,CAACA,IAAI,EAAEC,OAAO,CAAC,CAAC;EACxB,CAAC;AACH;AAACR,EAAA,CA/CQF,OAAO;AAAAuB,EAAA,GAAPvB,OAAO;AAiDhB,eAAeA,OAAO;AAAC,IAAAuB,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}